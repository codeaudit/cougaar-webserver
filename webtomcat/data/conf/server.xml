<?xml version="1.0" encoding="ISO-8859-1"?>

<!-- 
  Do NOT modify this file!  It is for Cougaar internal use only!

  This partially configures the "TomcatServletEngine" for Cougaar
  ServletService, in combination with Java code to configure
  the HTTP/HTTPS port listeners.  Eventually all of this XML file
  may move into code...
  -->

<Server>

    <ContextManager workDir="work" >

        <!-- 
            Do NOT alter this ordering! 
            I'm not sure if this is a minimal set...
          -->

        <LoaderInterceptor11  useApplicationLoader="true" />

        <TrustedLoader />

        <!-- 
            Tomcat logging MUST be disabled!

            LogSetter calls "org.apache.tomcat.util.log.Log"'s
            "public static void setLogManager(..)" method, which
            insists that the LogManager can only be set once.
            This breaks if Cougaar attempts to start Tomcat more
            than once (e.g. due to port scan to find a free port).

            I'll submit a bug report to the Tomcat team...
          -->
         <!--        
         <LogSetter name="tc_log" timestamps="true" verbosityLevel="FATAL"/> 
         -->

        <LogEvents enabled="false" />
        
        <ContextXmlReader config="conf/server.xml" />

        <AutoWebApp dir="webapps" host="DEFAULT" />

        <SimpleMapper1 />

        <SessionExpirer checkInterval="60" />
        
        <!-- this "/dev/urandom" is okay even on non-Linux machines -->
        <SessionIdGenerator 
            randomClass="java.security.SecureRandom" 
            randomFile="/dev/urandom" />

        <WebXmlReader validate="true" />

        <ErrorHandler showDebugInfo="true" />

        <WorkDirSetup cleanWorkDir="true" />

        <Jdk12Interceptor /> 

        <InvokerInterceptor /> 

        <SimpleSessionStore maxActiveSessions="-1" />

        <AccessInterceptor />
        <CredentialsInterceptor />

        <!-- 
          Form-based username/password support.

          The "web.xml" will force all "*.secure" requests
          to undergo username/password authentication.
          See "tomcat-users.xml" for the passwords list.

          Under Tomcat 4 we could plugin a custom Realm, which
          could read the username/passwords from "cougaar.rc".
          -->
        <SimpleRealm filename="conf/tomcat-users.xml"/>

        <LoadOnStartupInterceptor />

        <Servlet22Interceptor />

        <DecodeInterceptor /> 

        <SessionId cookiesFirst="true" noCookies="false" /> 

    </ContextManager>
</Server>
